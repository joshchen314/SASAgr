/* To read the data from excel file in the server by SAS EG and to save it as SAS library */

proc import datafile="\\saseg\D54\D54B\0_DATA\10308\SS104TT2.xlsx"
   DBMS=XLSX
   out=d102 REPLACE;
   SHEET="農事";
   range="A1:EL31";
   GETNAMES=YES;  
run;
/*PROC PRINT DATA=A102;
RUN;*/

/*步驟1-2*/
/*再用匯出的方式轉成SAS資料檔*/

/*步驟2*/
/*匯出後的資料檔再轉成文字檔*/
LIBNAME    Sdata     '\\SASEG\D54\D54B\0_DATA\10308' ;
FILENAME outd  '\\SASEG\D54\D54B\0_DATA\10308\04農事data.txt';                                                                                                                                                                                                                                                                                                                                                                    
DATA   B102txt;
SET  Sdata.d102;
FILE      outd         LRECL=376;                                                                                                            
  put 
   @1   D000000   13.
    @14   D010001   1.
    @15   D020001   3.
    @18   D030001   7.
    @25   D041001   1.
    @26   D042001   2.
    @28   D043001   1.
    @29   D051011   4.
    @33   D051021   4.
    @37   D051031   2.
    @39   D051041   4.
    @43   D052011   3.
    @46   D052012   3.
    @49   D052021   3.
    @52   D052022   3.
    @55   D052031   3.
    @58   D052032   3.
    @61   D062011   1.
    @62   D062012   1.
    @63   D062013   1.
    @64   D063011   8.
    @72   D064011   2.
    @74   D062021   1.
    @75   D062022   1.
    @76   D062023   1.
    @77   D063021   8.
    @85   D064021   2.
    @87   D062031   1.
    @88   D062032   1.
    @89   D062033   1.
    @90   D063031   8.
    @98   D064031   2.
    @100   D062041   1.
    @101   D062042   1.
    @102   D062043   1.
    @103   D063041   8.
    @111   D064041   2.
    @113   D062051   1.
    @114   D062052   1.
    @115   D062053   1.
    @116   D063051   8.
    @124   D064051   2.
    @126   D062061   1.
    @127   D062062   1.
    @128   D062063   1.
    @129   D063061   8.
    @137   D064061   2.
    @139   D062071   1.
    @140   D062072   1.
    @141   D062073   1.
    @142   D063071   8.
    @150   D064071   2.
    @152   D062081   1.
    @153   D062082   1.
    @154   D062083   1.
    @155   D063081   8.
    @163   D064081   2.
    @165   D062091   1.
    @166   D062092   1.
    @167   D062093   1.
    @168   D063091   8.
    @176   D064091   2.
    @178   D062101   1.
    @179   D062102   1.
    @180   D062103   1.
    @181   D063101   8.
    @189   D064101   2.
    @191   D062111   1.
    @192   D062112   1.
    @193   D062113   1.
    @194   D063111   8.
    @202   D064111   2.
    @204   D062121   1.
    @205   D062122   1.
    @206   D062123   1.
    @207   D063121   8.
    @215   D064121   2.
    @217   D062131   1.
    @218   D062132   1.
    @219   D062133   1.
    @220   D063131   8.
    @228   D064131   2.
    @230   D062141   1.
    @231   D062142   1.
    @232   D062143   1.
    @233   D063141   8.
    @241   D064141   2.
    @243   D062151   1.
    @244   D062152   1.
    @245   D062153   1.
    @246   D063151   8.
    @254   D064151   2.
    @256   D062161   1.
    @257   D062162   1.
    @258   D062163   1.
    @259   D063161   8.
    @267   D064161   2.
    @269   D062171   1.
    @270   D062172   1.
    @271   D062173   1.
    @272   D063171   8.
    @280   D064171   2.
    @282   D065001   2.
    @284   D070001   4.
    @288   D070002   4.
    @292   D070003   4.
    @296   D070004   4.
    @300   D070005   4.
    @304   D070006   4.
    @308   D070007   1.
    @309   D080001   2.
    @311   D080002   2.
    @313   D080003   2.
    @315   D080004   2.
    @317   D080005   2.
    @319   D080006   2.
    @321   D080007   2.
    @323   D080008   2.
    @325   D080009   2.
    @327   D080010   2.
    @329   D080011   2.
    @331   D080012   2.
    @333   D080013   2.
    @335   D080014   2.
    @337   D080015   2.
    @339   D080016   2.
    @341   D080017   2.
    @343   D080018   2.
    @345   D080019   2.
    @347   D080020   2.
    @349   D080021   2.
    @351   D080022   2.
    @353   D080023   2.
    @355   D080024   2.
    @357   D080025   2.
    @359   D080026   2.
    @361   D080027   2.
    @363   D080028   2.
    @365   D080029   2.
    @367   D080030   2.
    @369   D080031   1.
    @370     CHK      1.;
	run;
